<link rel="import" href="../../assets/libs/polymer/polymer.html">
<link rel="import" href="../../assets/libs/paper-toolbar/paper-toolbar.html">
<link rel="import" href="../../assets/libs/paper-card/paper-card.html">


<dom-module id="control-main-panel">
    <template>
        <paper-header-panel >

        </paper-header-panel>
        <div style="margin: 15px;">
            <paper-card heading="Table Desk" style="width:100%;">
                <div class="card-content" style="color: #444;">[[selectedData.content.text]]</div>
                <div class="card-actions">
                    <paper-button style="color: #000;" on-tap="handleDesk">Toggle Light</paper-button>
                </div>
            </paper-card>
            <paper-card style="margin-top: 15px;" heading="Card Title" image="https://unsplash.com/photos/NQSWvyVRIJk/download">
            </paper-card>
        </div>

        <iron-ajax
            id="testAjax"
            method="GET"
            url="/test"
            handle-as="json"
            last-response="{{serverData}}"
            on-response="handleTestData"></iron-ajax>
    </template>
    <script>
        var deviceStates = [{
            status : 1
        }];

        Polymer({
            is : 'control-main-panel',
            properties : {
                selectedData : {
                    type: Object,
                    observer: '_selectedIndexChanged'
                }
            },

            // Handle selection changed
            // Triggers mein view change
            _selectedIndexChanged : function(newValue) {
                console.log("value changed " + newValue);
            },

            handleDesk : function() {
                var ajaxRequest = this.$.testAjax;
                // Reverse current device state
                if(deviceStates[0].status) {
                    deviceStates[0].status = 0;
                }
                else {
                    deviceStates[0].status = 1;
                }

                ajaxRequest.url = "/test/1/" + deviceStates[0].status;

                console.log("URL", "/test/1/" + deviceStates[0].status);

                ajaxRequest.generateRequest();
            },
            handleTestData : function(data) {
                console.log("Server data", data, this.serverData);
            }
        })
    </script>
</dom-module>
